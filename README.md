# Ascent of volatile-rich felsic magma in dikes

## References
- 

## Input data
Input data for simulation generated by **input_article.m**.

> Chemical composition of silicate melts defined in line **40-42** (wt. %): [SiO2 TiO2 Al2O3 FeO(T) MnO MgO CaO Na2O K2O P2O5 H2O F2O-1].

> To describe mixed H2Oâ€“CO2 fluid saturation, we use the MagmaSat model (Ghiorso et al. 2015) implemented in VESIcal software  (Iacovino et al. 2021). Generated data (*pdpath0.X.mat*) are in **statePinatubo** folder and specified in line **80**
> 
> |filename|pdpath0.1.mat| pdpath0.2.mat| pdpath0.3.mat| pdpath0.4.mat| pdpath0.5.mat| pdpath0.6.mat| pdpath0.7.mat| pdpath0.8.mat| pdpath0.9.mat| pdpath1.0.mat|
> |---|---|---|---|---|---|---|---|---|---|---|
> |Dissolved water, %|2.37| 3.85| 5.13| 6.23| 8.13| 9.62| 11.15| 12.97| 15.36| 19.02|

> The mesh and time-step parameters are specified in **46-58** lines. The simulation time strongly depends on what parameters are defined in these fields and can vary from minutes to several hours.

## Output data
Simulation results saved in **simulation/simID_xxx** folder. One file for each time step (**timestep_xxxxx.mat**). In this file data saved as **FractureData** structure (class). For more details see **./src/base_classes/FractureElements.m**

## How to run simulation?
1. Run script **initialize_repo.m** to identify all scripts in matlab
2. Run input generator (**input** folder). 
3. Define generated **simID** into **runner.m** (11th line for input data and 12th line for the folder name where the simulation result is saved)
4. For debug purpose you can set option **plotFigure = true** to plot simulation result after each time step.
5. Scripts from **ArticlePlot** can be used to plot simulation results. 